<html>
    <head>
      <script src='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.js'></script>
      <link href='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.css' rel='stylesheet' />
        {% if title %}
        <title>{{ title }} - microblog</title>
        {% else %}
        <title>microblog</title>
        {% endif %}
    </head>
    <body>
      <div>
        Microblog:
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('login') }}">Login</a>
    </div>
        <hr>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <ul>
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
        <div id ='buttons'></div>
        
        <div id='map' style='width: 800px; height: 600px;'></div>
        <script>
          var map = new maplibregl.Map({
            container: 'map',
            style: 'https://web3d.basemap.de/maplibre/bm_web_col.json', // stylesheet location
            center: [50.67, 7.1], // starting position [lng, lat]
            zoom: 2, // starting zoom
            maplibreLogo : true,
            });
          
          // Add controls (optional)
          map.addControl(
               new maplibregl.NavigationControl({
                  visualizePitch: true,
                  showZoom: true,
                  showCompass: true
               })
            );
            
          map.addControl(
               new maplibregl.TerrainControl({
                  source: 'terrainSource',
                  exaggeration: 1
               })
            );

          const ids =  ['showTileBoundaries', 'showCollisionBoxes', 'showOverdrawInspector']
          ids.forEach(function(id){setEvents('buttons', id)})

          function setEvents(rootName,  id){
            const root = document.getElementById(rootName);  
            const group = document.createElement("div");
            root.append(group);

            const label = document.createElement("label");
            label.innerHTML = id
            group.append(label)  

            function addButton(name, event){
              const newButton = document.createElement("button");
              newButton.innerHTML = name
              group.append(newButton)
              newButton.addEventListener('click', event); 
            }

            addButton('on', function(){turnOn(id);});
            addButton('off', function(){turnOff(id);})
          }
          

          function turnOn(id) {
            turnOnOrOff(id, true)
          }   
          
          function turnOnOrOff(id, value) {
             map[id] = value;
             //map.showCollisionBoxes = value;
             //map['showOverdrawInspector'] = value;
          }  

          function turnOff(id) {
            turnOnOrOff(id, false)
          }   
  

        </script>
    </body>
</html>